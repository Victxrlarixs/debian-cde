---
// src/components/FileManager.astro
import WindowControls from '../common/WindowControls.astro';
import WindowMinimize from '../common/WindowMinimize.astro';
import { CONFIG } from '../../scripts/core/config';
---

<div class="window" id="fm">
  <div class="titlebar" onmousedown="drag(event, 'fm')">
    <WindowMinimize windowId="fm" />
    <span class="titlebar-text">victxrlarixs</span>
    <WindowControls windowId="fm" closeFunction="closeFileManager" />
  </div>
  <div class="fm-container">
    <div class="fm-menubar">
      <span>File</span>
      <span>Edit</span>
      <span>View</span>
      <span>Go</span>
      <span>Places</span>
      <a href={CONFIG.META.ISSUES_URL} target="_blank"><span>Help</span></a>
    </div>
    <div class="fm-toolbar">
      <button class="fm-btn" onclick="goBack()">
        <img src="/icons/actions/previous.png" alt="Back" />
      </button>
      <button class="fm-btn" onclick="goForward()">
        <img src="/icons/actions/right.png" alt="Forward" />
      </button>
      <button class="fm-btn" onclick="goUp()">
        <img src="/icons/actions/go-up.png" alt="Up" />
      </button>
      <button class="fm-btn" onclick="goHome()">
        <img src="/icons/actions/gohome.png" alt="Home" />
      </button>

      <div class="fm-path-container" id="fmPathContainer">
        <div id="fmBreadcrumbs" class="fm-breadcrumbs"></div>
        <input class="fm-path fm-hidden" id="fmPath" spellcheck="false" />
      </div>

      <div class="fm-search-container">
        <img src="/icons/apps/org.xfce.catfish.png" class="fm-search-icon" />
        <input class="fm-search-input" id="fmSearch" placeholder="Filter..." spellcheck="false" />
      </div>
    </div>
    <div class="fm-body">
      <div class="fm-sidebar">
        <div class="fm-section">Places</div>
        <div class="fm-item" onclick={`openPath('${CONFIG.FS.HOME}')`}>
          <img src="/icons/actions/gohome.png" class="fm-icon" /> victxrlarixs
        </div>
        <div class="fm-item" onclick={`openPath('${CONFIG.FS.DESKTOP}')`}>
          <img src="/icons/places/desktop.png" class="fm-icon" /> Desktop
        </div>
        <div class="fm-item" onclick={`openPath('${CONFIG.FS.TRASH}')`}>
          <img src="/icons/places/user-trash-full.png" class="fm-icon" /> Trash
        </div>
        <div class="fm-section">Devices</div>
        <div class="fm-item" onclick="openPath('/')">
          <img src="/icons/devices/floppy.png" class="fm-icon" /> File System
        </div>
        <div class="fm-section">Network</div>
        <div class="fm-item">
          <img src="/icons/devices/preferences-system-network.png" class="fm-icon" /> Browse Network
        </div>
      </div>
      <div class="fm-files" id="fmFiles"></div>
    </div>
    <div class="fm-status" id="fmStatus"></div>
  </div>
</div>

<script>
  import('../../scripts/features/filemanager.ts')
    .then((module) => {
      module.FileManager.init();
    })
    .catch((error) => {
      console.error('Error al cargar FileManager:', error);
    });
</script>
